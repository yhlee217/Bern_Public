# PDF/TXT 파싱 실습 - 라이브러리 설치 가이드

## 문제 해결: PyPDF2 import 오류

### 증상
```python
import PyPDF2  # ImportError 또는 모듈을 찾을 수 없음
```

### 원인
**PyPDF2 버전 3.x부터 모듈명이 변경되었습니다:**
- 구버전 (2.x): `PyPDF2`
- 신버전 (3.x): `pypdf`

### 해결 방법

#### 1단계: 라이브러리 설치 (이미 완료됨)
```bash
pip install PyPDF2 pdfplumber reportlab PyMuPDF
```

설치된 버전:
- PyPDF2: 3.0.1
- pdfplumber: 0.11.7
- reportlab: 4.4.4
- PyMuPDF: 1.26.5

#### 2단계: 올바른 import 방법

**방법 1: 버전 호환 코드 (권장)**
```python
# 두 버전 모두 지원
try:
    from pypdf import PdfReader, PdfWriter, PdfMerger
    print("pypdf (PyPDF2 3.x) 사용 중")
except ImportError:
    from PyPDF2 import PdfReader, PdfWriter, PdfMerger
    print("PyPDF2 2.x 사용 중")
```

**방법 2: 신버전 직접 사용**
```python
from pypdf import PdfReader, PdfWriter, PdfMerger
```

---

## TXT 파싱 실습 - 필요 라이브러리

### 기본 (Python 내장)
**별도 설치 불필요!**

- `open()` - 파일 읽기/쓰기
- `re` - 정규식
- `os` - 파일 시스템
- `csv` - CSV 파일 처리

### 선택적 (고급 기능)
```bash
# 인코딩 자동 감지
pip install chardet

# 데이터 분석
pip install pandas
```

### 실습 파일 실행 방법
```bash
cd "d:\00.Develop\CTO\R&D\25년 R&D-실습 과제(초급)\실습\txt_parsing"

# 기본 TXT 파서
python 01_basic_txt_parser.py

# 로그 파서
python 02_log_parser.py

# 구분자 기반 파서
python 03_delimited_parser.py

# 대용량 파일 파서
python 04_large_file_parser.py
```

---

## PDF 파싱 실습 - 필요 라이브러리

### 필수 라이브러리 (이미 설치됨)
```bash
pip install PyPDF2 pdfplumber reportlab PyMuPDF
```

### 실습 파일 실행 방법

#### 1. 샘플 PDF 생성
```bash
cd "d:\00.Develop\CTO\R&D\25년 R&D-실습 과제(초급)\실습\pdf_parsing"
python generate_sample_pdf.py
```

#### 2. 기본 PDF 파서 실행
```bash
python 01_basic_pdf_parser.py
```

---

## 설치 확인

### Python 버전 확인
```bash
python --version
# Python 3.7 이상 권장
```

### 설치된 라이브러리 확인
```bash
# PDF 관련
python -c "import pypdf; print(f'pypdf (PyPDF2): {pypdf.__version__}')"
python -c "import pdfplumber; print('pdfplumber: OK')"
python -c "import fitz; print('PyMuPDF: OK')"
python -c "import reportlab; print('reportlab: OK')"

# TXT 관련 (선택)
python -c "import chardet; print('chardet: OK')"
python -c "import pandas; print('pandas: OK')"
```

---

## 트러블슈팅

### 문제 1: "ModuleNotFoundError: No module named 'pypdf'"

**해결:**
```bash
pip install PyPDF2
```

### 문제 2: "ModuleNotFoundError: No module named 'reportlab'"

**해결:**
```bash
pip install reportlab
```

### 문제 3: 한글이 깨지는 경우

**원인:** 인코딩 문제

**해결:**
```python
# 파일 읽기 시 인코딩 명시
with open('file.txt', 'r', encoding='utf-8') as f:
    content = f.read()

# 또는 자동 감지
import chardet
with open('file.txt', 'rb') as f:
    result = chardet.detect(f.read())
    encoding = result['encoding']

with open('file.txt', 'r', encoding=encoding) as f:
    content = f.read()
```

### 문제 4: Windows 콘솔에서 이모지 출력 오류

**원인:** Windows 콘솔의 기본 인코딩(cp949)이 이모지를 지원하지 않음

**임시 해결:**
- 실습 파일의 이모지는 화면 출력용이므로 무시해도 기능에는 문제 없음
- 또는 VSCode 터미널 사용 (UTF-8 지원)

**근본 해결:**
```bash
# PowerShell에서
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
```

---

## 빠른 시작 가이드

### TXT 파싱 시작하기
```bash
cd "d:\00.Develop\CTO\R&D\25년 R&D-실습 과제(초급)\실습\txt_parsing"
python 01_basic_txt_parser.py
```

### PDF 파싱 시작하기
```bash
cd "d:\00.Develop\CTO\R&D\25년 R&D-실습 과제(초급)\실습\pdf_parsing"
python generate_sample_pdf.py
python 01_basic_pdf_parser.py
```

---

## 참고 문서

### 가이드 문서 위치
- TXT 파싱: `1.2.02.데이터 전처리 -파서(Parser) 만들기 (TXT).md`
- PDF 파싱: `1.2.03.데이터 전처리 -파서(Parser) 만들기 (PDF).md`

### 실습 파일 위치
- TXT 실습: `실습/txt_parsing/`
- PDF 실습: `실습/pdf_parsing/`

---

## 실습 파일 테스트 결과

### 테스트 완료 (2025-10-24)

모든 실습 파일이 성공적으로 실행되었습니다!

#### TXT 파싱 실습 파일 (4개)

| 파일명 | 상태 | 필수 라이브러리 | 비고 |
|--------|------|----------------|------|
| `01_basic_txt_parser.py` | ✅ 정상 | chardet | 인코딩 자동 감지 |
| `02_log_parser.py` | ✅ 정상 | Python 내장 | 별도 설치 불필요 |
| `03_delimited_parser.py` | ✅ 정상 | Python 내장 (csv) | 샘플 파일 자동 생성 |
| `04_large_file_parser.py` | ✅ 정상 | Python 내장 | 10만 줄 샘플 생성 (~5MB) |

#### PDF 파싱 실습 파일 (2개)

| 파일명 | 상태 | 필수 라이브러리 | 비고 |
|--------|------|----------------|------|
| `generate_sample_pdf.py` | ✅ 정상 | reportlab | 샘플 PDF 2개 생성 |
| `01_basic_pdf_parser.py` | ✅ 정상 | PyPDF2 (pypdf) | 버전 호환 코드 적용 |

### 설치된 라이브러리 버전 (확인됨)

```bash
# PDF 라이브러리
PyPDF2==3.0.1         # (모듈명: pypdf)
pdfplumber==0.11.7
reportlab==4.4.4
PyMuPDF==1.26.5       # (모듈명: fitz)

# TXT 라이브러리
chardet==5.2.0        # 인코딩 감지
```

### 주요 수정 사항

1. **PyPDF2 버전 호환성**
   - 모든 PDF 파일에 버전 호환 import 코드 추가
   - PyPDF2 2.x와 3.x 모두 지원

2. **Windows 이모지 인코딩 문제**
   - 모든 이모지를 ASCII 텍스트로 변경
   - 예: ✅ → [OK], ❌ → [ERROR], ⚠️ → [WARN]
   - Windows 콘솔(cp949) 호환성 확보

3. **샘플 데이터 파일**
   - `03_delimited_parser.py`: 자동으로 샘플 파일 생성
   - `04_large_file_parser.py`: 10만 줄 로그 파일 자동 생성
   - `generate_sample_pdf.py`: 2개의 샘플 PDF 생성

### 테스트 환경

- OS: Windows 10/11
- Python: 3.10
- 테스트 일자: 2025-10-24
- 모든 실습 파일: 정상 실행 확인 ✅

---

**작성일:** 2025-10-24 (최종 업데이트)
**작성자:** Bern
