# PDF 파일 파서(Parser) 가이드

## 목차

1. [PDF 파싱의 개념](#1-pdf-파싱의-개념)
2. [PDF 파일 구조 이해](#2-pdf-파일-구조-이해)
3. [Python PDF 파싱 라이브러리](#3-python-pdf-파싱-라이브러리)
4. [PyPDF2를 이용한 기본 파싱](#4-pypdf2를-이용한-기본-파싱)
5. [pdfplumber를 이용한 고급 파싱](#5-pdfplumber를-이용한-고급-파싱)
6. [테이블 데이터 추출](#6-테이블-데이터-추출)
7. [이미지 및 메타데이터 추출](#7-이미지-및-메타데이터-추출)
8. [실습 예제](#8-실습-예제)
9. [트러블슈팅](#9-트러블슈팅)
10. [베스트 프랙티스](#10-베스트-프랙티스)

---

## 1. PDF 파싱의 개념

### 📘 정의

**PDF 파싱**은 PDF (Portable Document Format) 파일에서 텍스트, 이미지, 테이블 등의 데이터를 추출하고, 구조화된 데이터로 변환하는 과정입니다.

### 🎯 PDF의 특징

- **고정 레이아웃**: 페이지 레이아웃이 고정되어 있음
- **복합 콘텐츠**: 텍스트, 이미지, 벡터 그래픽, 폰트 정보 등을 포함
- **압축**: 다양한 압축 알고리즘 사용
- **보안**: 암호화 및 권한 관리 기능
- **메타데이터**: 작성자, 생성일, 수정일 등의 정보 포함

### 📌 PDF 파싱의 주요 과제

| 과제 | 설명 | 해결 방법 |
|------|------|-----------|
| **텍스트 추출** | 폰트, 인코딩, 레이아웃 복잡성 | 전문 라이브러리 사용 |
| **레이아웃 유지** | 단락, 컬럼, 표 구조 파악 | 좌표 기반 분석 |
| **이미지 추출** | 이미지 포맷 변환 및 추출 | PIL/Pillow 라이브러리 |
| **암호화 처리** | 비밀번호로 보호된 PDF | 암호 해독 기능 |
| **OCR 필요성** | 스캔된 PDF (이미지 기반) | Tesseract OCR 사용 |

---

## 2. PDF 파일 구조 이해

### PDF 파일의 내부 구조

```text
PDF 파일 구조
├── Header (헤더)
│   └── %PDF-1.7 (PDF 버전 정보)
├── Body (본문)
│   ├── Objects (객체)
│   │   ├── Pages (페이지)
│   │   ├── Fonts (폰트)
│   │   ├── Images (이미지)
│   │   └── Contents (콘텐츠)
│   └── Streams (스트림 데이터)
├── Cross-Reference Table (참조 테이블)
│   └── 객체 위치 정보
└── Trailer (트레일러)
    └── 문서 메타데이터
```

### PDF 콘텐츠 유형

| 유형 | 설명 | 추출 난이도 |
|------|------|-------------|
| **텍스트 PDF** | 실제 텍스트 데이터 포함 | 쉬움 |
| **이미지 PDF** | 스캔된 문서 (OCR 필요) | 어려움 |
| **하이브리드 PDF** | 텍스트 + 이미지 혼합 | 중간 |
| **폼 PDF** | 입력 가능한 양식 | 중간 |
| **암호화 PDF** | 비밀번호 보호 | 어려움 |

---

## 3. Python PDF 파싱 라이브러리

### 주요 라이브러리 비교

| 라이브러리 | 장점 | 단점 | 추천 용도 |
|-----------|------|------|-----------|
| **PyPDF2** | - 설치 간단<br>- 기본 기능 충실<br>- 문서 조작 가능 | - 복잡한 PDF 처리 한계<br>- 테이블 추출 미지원 | 단순 텍스트 추출, PDF 병합/분할 |
| **pdfplumber** | - 테이블 추출 강력<br>- 좌표 기반 정밀 추출<br>- 시각화 기능 | - 속도가 느림<br>- 대용량 파일 처리 부담 | 테이블 데이터 추출, 정밀한 레이아웃 분석 |
| **PyMuPDF (fitz)** | - 매우 빠른 속도<br>- 이미지 추출 우수<br>- PDF 렌더링 가능 | - 설치 용량 큼<br>- 학습 곡선 | 대용량 PDF, 이미지 추출, 고성능 요구 |
| **pdfminer.six** | - 저수준 API<br>- 세밀한 제어 가능 | - 사용법 복잡<br>- 문서 부족 | 고급 사용자, 커스텀 파서 개발 |
| **tabula-py** | - 테이블 추출 특화<br>- Pandas 통합 | - Java 의존성<br>- 테이블만 지원 | 테이블 중심 문서 |
| **camelot-py** | - 테이블 추출 최상급<br>- 정확도 높음 | - 설치 복잡<br>- Ghostscript 필요 | 복잡한 테이블 구조 |

### 설치 방법

#### 기본 설치

```bash
# 필수 라이브러리 한 번에 설치 (권장)
pip install PyPDF2 pdfplumber reportlab PyMuPDF

# 또는 개별 설치
pip install PyPDF2        # 기본 PDF 처리
pip install pdfplumber    # 테이블 추출
pip install PyMuPDF       # 고성능 처리
pip install reportlab     # PDF 생성 (샘플 파일용)
```

#### ⚠️ 중요: PyPDF2 버전 이슈

**PyPDF2 버전에 따라 import 방법이 다릅니다:**

```python
# PyPDF2 3.x 버전 (최신)
from pypdf import PdfReader, PdfWriter, PdfMerger

# PyPDF2 2.x 버전 (구버전)
from PyPDF2 import PdfReader, PdfWriter, PdfMerger
```

**버전 호환성 코드 (권장):**

```python
# 양쪽 버전 모두 지원
try:
    from pypdf import PdfReader, PdfWriter, PdfMerger
    print("✅ pypdf (PyPDF2 3.x) 사용")
except ImportError:
    from PyPDF2 import PdfReader, PdfWriter, PdfMerger
    print("✅ PyPDF2 2.x 사용")
```

#### 설치 확인

```bash
# Python에서 라이브러리 확인
python -c "import pypdf; print(f'PyPDF2 버전: {pypdf.__version__}')"
python -c "import pdfplumber; print('pdfplumber 설치 완료')"
python -c "import fitz; print('PyMuPDF 설치 완료')"
```

### 라이브러리 버전 정보

| 라이브러리 | 최신 버전 | 주요 변경사항 |
|-----------|----------|--------------|
| PyPDF2 | 3.0+ | 모듈명이 `PyPDF2`에서 `pypdf`로 변경 |
| pdfplumber | 0.11+ | 안정적인 테이블 추출 |
| PyMuPDF | 1.24+ | 성능 최적화 |
| reportlab | 4.0+ | Python 3.10+ 지원 |

### 선택적 설치 (고급 기능)

# pdfminer.six (저수준)
pip install pdfminer.six

# tabula-py (테이블 특화)
pip install tabula-py

# camelot-py (테이블 전문)
pip install camelot-py[cv]  # OpenCV 포함
```

---

## 4. PyPDF2를 이용한 기본 파싱

### 4.1 PDF 파일 열기 및 정보 추출

```python
import PyPDF2

def extract_pdf_info(pdf_path):
    """
    PDF 메타데이터 추출
    """
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)

        # 기본 정보
        num_pages = len(reader.pages)
        metadata = reader.metadata

        print(f"📄 페이지 수: {num_pages}")
        print(f"📝 제목: {metadata.title}")
        print(f"👤 작성자: {metadata.author}")
        print(f"📅 생성일: {metadata.creation_date}")

        return {
            'num_pages': num_pages,
            'metadata': metadata
        }

# 사용 예시
info = extract_pdf_info('document.pdf')
```

### 4.2 텍스트 추출

```python
def extract_text_pypdf2(pdf_path):
    """
    PDF에서 전체 텍스트 추출
    """
    text_content = []

    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)

        # 모든 페이지 순회
        for page_num, page in enumerate(reader.pages, start=1):
            # 페이지에서 텍스트 추출
            text = page.extract_text()

            text_content.append({
                'page': page_num,
                'text': text
            })

            print(f"페이지 {page_num}: {len(text)}자 추출")

    return text_content

# 사용 예시
content = extract_text_pypdf2('document.pdf')

# 전체 텍스트 결합
full_text = '\n'.join(page['text'] for page in content)
print(full_text)
```

### 4.3 PDF 파일 조작

```python
def merge_pdfs(pdf_list, output_path):
    """
    여러 PDF 파일을 하나로 병합
    """
    merger = PyPDF2.PdfMerger()

    for pdf in pdf_list:
        merger.append(pdf)

    merger.write(output_path)
    merger.close()

    print(f"✅ PDF 병합 완료: {output_path}")

def split_pdf(pdf_path, output_dir):
    """
    PDF를 페이지별로 분할
    """
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)

        for page_num, page in enumerate(reader.pages, start=1):
            writer = PyPDF2.PdfWriter()
            writer.add_page(page)

            output_file = f"{output_dir}/page_{page_num}.pdf"
            with open(output_file, 'wb') as output:
                writer.write(output)

            print(f"페이지 {page_num} 저장: {output_file}")

# 사용 예시
merge_pdfs(['doc1.pdf', 'doc2.pdf'], 'merged.pdf')
split_pdf('document.pdf', 'output')
```

---

## 5. pdfplumber를 이용한 고급 파싱

### 5.1 정밀한 텍스트 추출

```python
import pdfplumber

def extract_text_pdfplumber(pdf_path):
    """
    pdfplumber로 텍스트 추출 (레이아웃 정보 포함)
    """
    with pdfplumber.open(pdf_path) as pdf:
        for page_num, page in enumerate(pdf.pages, start=1):
            # 텍스트 추출
            text = page.extract_text()

            # 페이지 크기 정보
            width = page.width
            height = page.height

            print(f"\n페이지 {page_num} ({width}x{height}):")
            print(text)

            # 단어 단위로 추출 (좌표 포함)
            words = page.extract_words()
            print(f"\n단어 수: {len(words)}")

            # 첫 5개 단어의 좌표 출력
            for word in words[:5]:
                print(f"  '{word['text']}' at ({word['x0']}, {word['top']})")

# 사용 예시
extract_text_pdfplumber('document.pdf')
```

### 5.2 영역 기반 추출

```python
def extract_text_from_region(pdf_path, page_num, bbox):
    """
    특정 영역에서만 텍스트 추출

    Args:
        bbox (tuple): (x0, y0, x1, y1) 좌표
    """
    with pdfplumber.open(pdf_path) as pdf:
        page = pdf.pages[page_num - 1]

        # 영역 잘라내기
        cropped = page.within_bbox(bbox)

        # 텍스트 추출
        text = cropped.extract_text()

        print(f"영역 {bbox}에서 추출:")
        print(text)

        return text

# 사용 예시 (왼쪽 상단 100x100 영역)
text = extract_text_from_region('document.pdf', page_num=1, bbox=(0, 0, 100, 100))
```

---

## 6. 테이블 데이터 추출

### 6.1 pdfplumber를 이용한 테이블 추출

```python
import pdfplumber
import pandas as pd

def extract_tables_pdfplumber(pdf_path):
    """
    PDF에서 테이블 추출 및 DataFrame으로 변환
    """
    all_tables = []

    with pdfplumber.open(pdf_path) as pdf:
        for page_num, page in enumerate(pdf.pages, start=1):
            # 페이지에서 테이블 추출
            tables = page.extract_tables()

            if tables:
                print(f"\n페이지 {page_num}: {len(tables)}개 테이블 발견")

                for table_num, table in enumerate(tables, start=1):
                    # pandas DataFrame으로 변환
                    df = pd.DataFrame(table[1:], columns=table[0])

                    print(f"\n테이블 {table_num}:")
                    print(df)

                    all_tables.append({
                        'page': page_num,
                        'table_num': table_num,
                        'dataframe': df
                    })

    return all_tables

# 사용 예시
tables = extract_tables_pdfplumber('report.pdf')

# 첫 번째 테이블 CSV로 저장
if tables:
    tables[0]['dataframe'].to_csv('table_1.csv', index=False)
```

### 6.2 테이블 설정 커스터마이징

```python
def extract_tables_custom_settings(pdf_path):
    """
    테이블 감지 설정을 조정하여 추출
    """
    table_settings = {
        "vertical_strategy": "lines",      # 세로 구분선 감지 전략
        "horizontal_strategy": "lines",    # 가로 구분선 감지 전략
        "explicit_vertical_lines": [],     # 명시적 세로선
        "explicit_horizontal_lines": [],   # 명시적 가로선
        "snap_tolerance": 3,               # 선 스냅 허용 오차
        "join_tolerance": 3,               # 선 결합 허용 오차
        "edge_min_length": 3,              # 최소 선 길이
        "min_words_vertical": 3,           # 세로 방향 최소 단어 수
        "min_words_horizontal": 1,         # 가로 방향 최소 단어 수
    }

    with pdfplumber.open(pdf_path) as pdf:
        for page in pdf.pages:
            # 커스텀 설정으로 테이블 추출
            tables = page.extract_tables(table_settings)

            for table in tables:
                df = pd.DataFrame(table[1:], columns=table[0])
                print(df)

# 사용 예시
extract_tables_custom_settings('complex_table.pdf')
```

### 6.3 tabula-py를 이용한 테이블 추출

```python
import tabula

def extract_tables_tabula(pdf_path):
    """
    tabula-py로 테이블 추출 (Java 기반)
    """
    # 방법 1: 모든 테이블을 리스트로
    tables = tabula.read_pdf(
        pdf_path,
        pages='all',
        multiple_tables=True,
        lattice=True  # 선으로 구분된 테이블
    )

    for i, table in enumerate(tables, start=1):
        print(f"\n테이블 {i}:")
        print(table)

    # 방법 2: 직접 DataFrame으로
    df = tabula.read_pdf(
        pdf_path,
        pages='1',
        area=[50, 50, 500, 500],  # (y1, x1, y2, x2) 영역 지정
        columns=[100, 200, 300]    # 컬럼 구분선
    )[0]

    print("\n영역 지정 추출:")
    print(df)

    return tables

# 사용 예시
tables = extract_tables_tabula('financial_report.pdf')
```

---

## 7. 이미지 및 메타데이터 추출

### 7.1 PyMuPDF를 이용한 이미지 추출

```python
import fitz  # PyMuPDF
from PIL import Image
import io

def extract_images_pymupdf(pdf_path, output_dir):
    """
    PDF에서 이미지 추출
    """
    import os
    os.makedirs(output_dir, exist_ok=True)

    pdf_document = fitz.open(pdf_path)

    image_count = 0

    for page_num in range(len(pdf_document)):
        page = pdf_document[page_num]

        # 페이지에서 이미지 목록 가져오기
        images = page.get_images(full=True)

        print(f"페이지 {page_num + 1}: {len(images)}개 이미지")

        for img_index, img in enumerate(images):
            xref = img[0]  # 이미지 참조 번호

            # 이미지 데이터 추출
            base_image = pdf_document.extract_image(xref)
            image_bytes = base_image["image"]
            image_ext = base_image["ext"]

            # 이미지 저장
            image_count += 1
            image_filename = f"{output_dir}/image_{page_num + 1}_{img_index + 1}.{image_ext}"

            with open(image_filename, "wb") as img_file:
                img_file.write(image_bytes)

            print(f"  저장: {image_filename}")

    pdf_document.close()
    print(f"\n✅ 총 {image_count}개 이미지 추출 완료")

# 사용 예시
extract_images_pymupdf('document.pdf', 'extracted_images')
```

### 7.2 메타데이터 추출 및 수정

```python
def extract_metadata(pdf_path):
    """
    PDF 메타데이터 상세 추출
    """
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)
        metadata = reader.metadata

        print("📋 PDF 메타데이터:")
        print(f"  제목: {metadata.get('/Title', 'N/A')}")
        print(f"  작성자: {metadata.get('/Author', 'N/A')}")
        print(f"  주제: {metadata.get('/Subject', 'N/A')}")
        print(f"  키워드: {metadata.get('/Keywords', 'N/A')}")
        print(f"  생성 프로그램: {metadata.get('/Creator', 'N/A')}")
        print(f"  PDF 생성기: {metadata.get('/Producer', 'N/A')}")
        print(f"  생성일: {metadata.get('/CreationDate', 'N/A')}")
        print(f"  수정일: {metadata.get('/ModDate', 'N/A')}")

        return metadata

def add_metadata(input_pdf, output_pdf, metadata_dict):
    """
    PDF에 메타데이터 추가/수정
    """
    reader = PyPDF2.PdfReader(input_pdf)
    writer = PyPDF2.PdfWriter()

    # 모든 페이지 복사
    for page in reader.pages:
        writer.add_page(page)

    # 메타데이터 추가
    writer.add_metadata(metadata_dict)

    # 저장
    with open(output_pdf, 'wb') as output:
        writer.write(output)

    print(f"✅ 메타데이터 추가 완료: {output_pdf}")

# 사용 예시
metadata = extract_metadata('document.pdf')

new_metadata = {
    '/Title': '새로운 제목',
    '/Author': '홍길동',
    '/Subject': '문서 주제',
    '/Keywords': 'Python, PDF, 파싱'
}
add_metadata('document.pdf', 'document_with_metadata.pdf', new_metadata)
```

---

## 8. 실습 예제

실습 예제는 `실습/pdf_parsing/` 디렉토리에서 확인할 수 있습니다:

1. **[기본 PDF 파서](실습/pdf_parsing/01_basic_pdf_parser.py)**: PyPDF2 기본 사용법
2. **[텍스트 추출기](실습/pdf_parsing/02_text_extractor.py)**: 다양한 방법으로 텍스트 추출
3. **[테이블 추출기](실습/pdf_parsing/03_table_extractor.py)**: pdfplumber로 테이블 추출
4. **[이미지 추출기](실습/pdf_parsing/04_image_extractor.py)**: PyMuPDF로 이미지 추출
5. **[통합 예제](실습/pdf_parsing/05_comprehensive_pdf_parser.py)**: 실전 PDF 파싱

### 테스트 데이터

- [샘플 PDF 생성기](실습/pdf_parsing/generate_sample_pdf.py)
- [테이블 포함 PDF](실습/pdf_parsing/data/sample_table.pdf)
- [이미지 포함 PDF](실습/pdf_parsing/data/sample_with_images.pdf)

---

## 9. 트러블슈팅

### 9.1 텍스트 추출 문제

#### 문제: 텍스트가 깨지거나 순서가 뒤죽박죽

```python
# ❌ 문제 상황
text = page.extract_text()
# 출력: "안녕하세요 름저제 은"

# ✅ 해결 방법 1: pdfplumber 사용
import pdfplumber
with pdfplumber.open('document.pdf') as pdf:
    text = pdf.pages[0].extract_text()

# ✅ 해결 방법 2: layout 모드 사용
from pdfminer.high_level import extract_text_to_fp
from pdfminer.layout import LAParams

laparams = LAParams()
with open('document.pdf', 'rb') as fp:
    extract_text_to_fp(fp, output, laparams=laparams)
```

#### 문제: 한글이 추출되지 않음

```python
# 원인: 폰트 임베딩 문제 또는 이미지 기반 PDF

# ✅ 해결 방법: OCR 사용
import pytesseract
from pdf2image import convert_from_path

# PDF를 이미지로 변환
images = convert_from_path('document.pdf')

# OCR로 텍스트 추출
for i, image in enumerate(images):
    text = pytesseract.image_to_string(image, lang='kor+eng')
    print(f"페이지 {i+1}:\n{text}")
```

### 9.2 암호화된 PDF 처리

```python
def decrypt_pdf(pdf_path, password):
    """
    암호화된 PDF 열기
    """
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)

        # 암호화 여부 확인
        if reader.is_encrypted:
            # 비밀번호로 해독 시도
            if reader.decrypt(password):
                print("✅ PDF 잠금 해제 성공")

                # 텍스트 추출
                text = reader.pages[0].extract_text()
                return text
            else:
                print("❌ 비밀번호가 틀립니다")
                return None
        else:
            print("🔓 암호화되지 않은 PDF입니다")

# 사용 예시
text = decrypt_pdf('encrypted.pdf', 'password123')
```

### 9.3 테이블 추출 실패

```python
# 문제: 테이블이 감지되지 않음

# ✅ 해결 방법 1: 테이블 설정 조정
table_settings = {
    "vertical_strategy": "text",  # "lines" 대신 "text" 사용
    "horizontal_strategy": "text",
    "intersection_tolerance": 15,
}

tables = page.extract_tables(table_settings)

# ✅ 해결 방법 2: camelot 사용 (더 강력)
import camelot

tables = camelot.read_pdf('document.pdf', pages='1', flavor='lattice')
print(tables[0].df)  # DataFrame 출력
```

### 9.4 메모리 문제

```python
# 문제: 대용량 PDF 처리 시 메모리 부족

# ✅ 해결 방법: 페이지별 처리 및 메모리 해제
import gc

def process_large_pdf(pdf_path):
    with pdfplumber.open(pdf_path) as pdf:
        total_pages = len(pdf.pages)

        for i in range(total_pages):
            # 한 페이지씩 처리
            page = pdf.pages[i]
            text = page.extract_text()

            # 처리 작업 수행
            process_text(text)

            # 명시적 메모리 해제
            if i % 10 == 0:
                gc.collect()
                print(f"진행률: {i/total_pages*100:.1f}%")

# 사용 예시
process_large_pdf('large_document.pdf')
```

### 9.5 좌표 시스템 이해

```python
"""
PDF 좌표 시스템:
- 원점(0,0)은 왼쪽 하단
- x는 오른쪽으로 증가
- y는 위쪽으로 증가

pdfplumber 좌표:
- 원점(0,0)은 왼쪽 상단
- x는 오른쪽으로 증가
- y는 아래쪽으로 증가
"""

def convert_coordinates(page_height, y_from_bottom):
    """
    PDF 좌표를 pdfplumber 좌표로 변환
    """
    y_from_top = page_height - y_from_bottom
    return y_from_top
```

---

## 10. 베스트 프랙티스

### ✅ PDF 파싱 설계 원칙

1. **적절한 라이브러리 선택**
   ```python
   # 단순 텍스트 추출 → PyPDF2
   # 테이블 추출 → pdfplumber 또는 tabula
   # 고성능 필요 → PyMuPDF
   # 이미지 기반 PDF → pytesseract (OCR)
   ```

2. **에러 처리**
   ```python
   def safe_extract_text(pdf_path):
       try:
           with pdfplumber.open(pdf_path) as pdf:
               return pdf.pages[0].extract_text()
       except Exception as e:
           print(f"오류: {e}")
           return None
   ```

3. **메모리 관리**
   ```python
   # ✅ 권장: with 구문 사용
   with pdfplumber.open(pdf_path) as pdf:
       text = pdf.pages[0].extract_text()

   # ❌ 비권장: 수동 닫기
   pdf = pdfplumber.open(pdf_path)
   text = pdf.pages[0].extract_text()
   pdf.close()
   ```

4. **결과 검증**
   ```python
   def validate_extraction(text):
       """
       추출된 텍스트 검증
       """
       if not text or len(text) < 10:
           print("⚠️  추출된 텍스트가 너무 짧습니다")
           return False

       # 깨진 문자 확인
       if '�' in text or text.count('\\ufffd') > 0:
           print("⚠️  깨진 문자가 포함되어 있습니다")
           return False

       return True
   ```

5. **로깅 및 모니터링**
   ```python
   import logging

   logging.basicConfig(level=logging.INFO)
   logger = logging.getLogger(__name__)

   def extract_with_logging(pdf_path):
       logger.info(f"PDF 파싱 시작: {pdf_path}")

       try:
           with pdfplumber.open(pdf_path) as pdf:
               logger.info(f"총 페이지 수: {len(pdf.pages)}")

               for i, page in enumerate(pdf.pages, 1):
                   text = page.extract_text()
                   logger.info(f"페이지 {i}: {len(text)}자 추출")

           logger.info("PDF 파싱 완료")

       except Exception as e:
           logger.error(f"PDF 파싱 실패: {e}")
   ```

### 🚫 피해야 할 사항

- ❌ 모든 페이지를 한 번에 메모리에 로드
- ❌ 라이브러리 의존성 미확인 (Java, Ghostscript 등)
- ❌ 텍스트 추출 실패 시 대안 없음
- ❌ 암호화/권한 확인 없이 처리
- ❌ 좌표 시스템 차이 무시

### 📈 성능 최적화

| 기법 | 설명 | 적용 시점 |
|------|------|-----------|
| **페이지별 처리** | 한 페이지씩 처리하여 메모리 절약 | 대용량 PDF |
| **병렬 처리** | 멀티프로세싱으로 속도 향상 | 여러 PDF 파일 |
| **캐싱** | 반복 접근하는 데이터 캐싱 | 동일 PDF 재처리 |
| **선택적 추출** | 필요한 영역만 추출 | 특정 영역 데이터 |
| **라이브러리 선택** | 작업에 맞는 최적 라이브러리 | 항상 |

```python
# 성능 측정 예시
import time

def benchmark_pdf_extraction(pdf_path):
    """
    다양한 방법의 성능 비교
    """
    # PyPDF2
    start = time.time()
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)
        text1 = reader.pages[0].extract_text()
    time1 = time.time() - start

    # pdfplumber
    start = time.time()
    with pdfplumber.open(pdf_path) as pdf:
        text2 = pdf.pages[0].extract_text()
    time2 = time.time() - start

    # PyMuPDF
    start = time.time()
    doc = fitz.open(pdf_path)
    text3 = doc[0].get_text()
    doc.close()
    time3 = time.time() - start

    print(f"PyPDF2:     {time1:.3f}초")
    print(f"pdfplumber: {time2:.3f}초")
    print(f"PyMuPDF:    {time3:.3f}초")
```

---

## ✅ 요약

| 구분 | 내용 |
|------|------|
| **기본 라이브러리** | PyPDF2 (기본), pdfplumber (테이블), PyMuPDF (고성능) |
| **주요 기능** | 텍스트 추출, 테이블 추출, 이미지 추출, 메타데이터 처리 |
| **특수 처리** | OCR (pytesseract), 암호화 (decrypt), 대용량 (페이지별) |
| **주의사항** | 좌표 시스템, 메모리 관리, 인코딩 문제, 폰트 임베딩 |
| **성능** | PyMuPDF > PyPDF2 > pdfplumber (테이블 제외) |

---

## 📚 참고 자료

### Python 라이브러리 문서
- [PyPDF2 Documentation](https://pypdf2.readthedocs.io/)
- [pdfplumber Documentation](https://github.com/jsvine/pdfplumber)
- [PyMuPDF Documentation](https://pymupdf.readthedocs.io/)
- [tabula-py Documentation](https://tabula-py.readthedocs.io/)
- [camelot Documentation](https://camelot-py.readthedocs.io/)

### PDF 스펙 및 가이드
- [PDF Reference (Adobe)](https://www.adobe.com/devnet/pdf/pdf_reference.html)
- [PDF 1.7 Specification (ISO 32000)](https://www.iso.org/standard/51502.html)

### 온라인 리소스
- [Real Python - Working with PDFs in Python](https://realpython.com/pdf-python/)
- [DataCamp - Reading PDFs in Python](https://www.datacamp.com/tutorial/reading-pdfs-in-python)

### OCR 관련
- [Tesseract OCR](https://github.com/tesseract-ocr/tesseract)
- [pytesseract](https://pypi.org/project/pytesseract/)
- [pdf2image](https://pypi.org/project/pdf2image/)

---

## 📌 다음 단계

PDF 파싱을 익혔다면, 다음은 **청커(Chunker) 만들기**입니다.

**다음 문서**: [1.2.04. 데이터 전처리 - 청커(Chunker) 만들기 (1)](./1.2.04.데이터%20전처리%20-%20청커(Chunker)%20만들기(1).md)

---

**문서 버전**: 1.0
**최종 수정일**: 2025-10-23
**작성자**: Bern
