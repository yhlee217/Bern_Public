# PDF íŒŒì¼ íŒŒì„œ(Parser) ê°€ì´ë“œ

## ëª©ì°¨

1. [PDF íŒŒì‹±ì˜ ê°œë…](#1-pdf-íŒŒì‹±ì˜-ê°œë…)
2. [PDF íŒŒì¼ êµ¬ì¡° ì´í•´](#2-pdf-íŒŒì¼-êµ¬ì¡°-ì´í•´)
3. [Python PDF íŒŒì‹± ë¼ì´ë¸ŒëŸ¬ë¦¬](#3-python-pdf-íŒŒì‹±-ë¼ì´ë¸ŒëŸ¬ë¦¬)
4. [PyPDF2ë¥¼ ì´ìš©í•œ ê¸°ë³¸ íŒŒì‹±](#4-pypdf2ë¥¼-ì´ìš©í•œ-ê¸°ë³¸-íŒŒì‹±)
5. [pdfplumberë¥¼ ì´ìš©í•œ ê³ ê¸‰ íŒŒì‹±](#5-pdfplumberë¥¼-ì´ìš©í•œ-ê³ ê¸‰-íŒŒì‹±)
6. [í…Œì´ë¸” ë°ì´í„° ì¶”ì¶œ](#6-í…Œì´ë¸”-ë°ì´í„°-ì¶”ì¶œ)
7. [ì´ë¯¸ì§€ ë° ë©”íƒ€ë°ì´í„° ì¶”ì¶œ](#7-ì´ë¯¸ì§€-ë°-ë©”íƒ€ë°ì´í„°-ì¶”ì¶œ)
8. [ì‹¤ìŠµ ì˜ˆì œ](#8-ì‹¤ìŠµ-ì˜ˆì œ)
9. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#9-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
10. [ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤](#10-ë² ìŠ¤íŠ¸-í”„ë™í‹°ìŠ¤)

---

## 1. PDF íŒŒì‹±ì˜ ê°œë…

### ğŸ“˜ ì •ì˜

**PDF íŒŒì‹±**ì€ PDF (Portable Document Format) íŒŒì¼ì—ì„œ í…ìŠ¤íŠ¸, ì´ë¯¸ì§€, í…Œì´ë¸” ë“±ì˜ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê³ , êµ¬ì¡°í™”ëœ ë°ì´í„°ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.

### ğŸ¯ PDFì˜ íŠ¹ì§•

- **ê³ ì • ë ˆì´ì•„ì›ƒ**: í˜ì´ì§€ ë ˆì´ì•„ì›ƒì´ ê³ ì •ë˜ì–´ ìˆìŒ
- **ë³µí•© ì½˜í…ì¸ **: í…ìŠ¤íŠ¸, ì´ë¯¸ì§€, ë²¡í„° ê·¸ë˜í”½, í°íŠ¸ ì •ë³´ ë“±ì„ í¬í•¨
- **ì••ì¶•**: ë‹¤ì–‘í•œ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
- **ë³´ì•ˆ**: ì•”í˜¸í™” ë° ê¶Œí•œ ê´€ë¦¬ ê¸°ëŠ¥
- **ë©”íƒ€ë°ì´í„°**: ì‘ì„±ì, ìƒì„±ì¼, ìˆ˜ì •ì¼ ë“±ì˜ ì •ë³´ í¬í•¨

### ğŸ“Œ PDF íŒŒì‹±ì˜ ì£¼ìš” ê³¼ì œ

| ê³¼ì œ | ì„¤ëª… | í•´ê²° ë°©ë²• |
|------|------|-----------|
| **í…ìŠ¤íŠ¸ ì¶”ì¶œ** | í°íŠ¸, ì¸ì½”ë”©, ë ˆì´ì•„ì›ƒ ë³µì¡ì„± | ì „ë¬¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© |
| **ë ˆì´ì•„ì›ƒ ìœ ì§€** | ë‹¨ë½, ì»¬ëŸ¼, í‘œ êµ¬ì¡° íŒŒì•… | ì¢Œí‘œ ê¸°ë°˜ ë¶„ì„ |
| **ì´ë¯¸ì§€ ì¶”ì¶œ** | ì´ë¯¸ì§€ í¬ë§· ë³€í™˜ ë° ì¶”ì¶œ | PIL/Pillow ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| **ì•”í˜¸í™” ì²˜ë¦¬** | ë¹„ë°€ë²ˆí˜¸ë¡œ ë³´í˜¸ëœ PDF | ì•”í˜¸ í•´ë… ê¸°ëŠ¥ |
| **OCR í•„ìš”ì„±** | ìŠ¤ìº”ëœ PDF (ì´ë¯¸ì§€ ê¸°ë°˜) | Tesseract OCR ì‚¬ìš© |

---

## 2. PDF íŒŒì¼ êµ¬ì¡° ì´í•´

### PDF íŒŒì¼ì˜ ë‚´ë¶€ êµ¬ì¡°

```text
PDF íŒŒì¼ êµ¬ì¡°
â”œâ”€â”€ Header (í—¤ë”)
â”‚   â””â”€â”€ %PDF-1.7 (PDF ë²„ì „ ì •ë³´)
â”œâ”€â”€ Body (ë³¸ë¬¸)
â”‚   â”œâ”€â”€ Objects (ê°ì²´)
â”‚   â”‚   â”œâ”€â”€ Pages (í˜ì´ì§€)
â”‚   â”‚   â”œâ”€â”€ Fonts (í°íŠ¸)
â”‚   â”‚   â”œâ”€â”€ Images (ì´ë¯¸ì§€)
â”‚   â”‚   â””â”€â”€ Contents (ì½˜í…ì¸ )
â”‚   â””â”€â”€ Streams (ìŠ¤íŠ¸ë¦¼ ë°ì´í„°)
â”œâ”€â”€ Cross-Reference Table (ì°¸ì¡° í…Œì´ë¸”)
â”‚   â””â”€â”€ ê°ì²´ ìœ„ì¹˜ ì •ë³´
â””â”€â”€ Trailer (íŠ¸ë ˆì¼ëŸ¬)
    â””â”€â”€ ë¬¸ì„œ ë©”íƒ€ë°ì´í„°
```

### PDF ì½˜í…ì¸  ìœ í˜•

| ìœ í˜• | ì„¤ëª… | ì¶”ì¶œ ë‚œì´ë„ |
|------|------|-------------|
| **í…ìŠ¤íŠ¸ PDF** | ì‹¤ì œ í…ìŠ¤íŠ¸ ë°ì´í„° í¬í•¨ | ì‰¬ì›€ |
| **ì´ë¯¸ì§€ PDF** | ìŠ¤ìº”ëœ ë¬¸ì„œ (OCR í•„ìš”) | ì–´ë ¤ì›€ |
| **í•˜ì´ë¸Œë¦¬ë“œ PDF** | í…ìŠ¤íŠ¸ + ì´ë¯¸ì§€ í˜¼í•© | ì¤‘ê°„ |
| **í¼ PDF** | ì…ë ¥ ê°€ëŠ¥í•œ ì–‘ì‹ | ì¤‘ê°„ |
| **ì•”í˜¸í™” PDF** | ë¹„ë°€ë²ˆí˜¸ ë³´í˜¸ | ì–´ë ¤ì›€ |

---

## 3. Python PDF íŒŒì‹± ë¼ì´ë¸ŒëŸ¬ë¦¬

### ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¹„êµ

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ì¥ì  | ë‹¨ì  | ì¶”ì²œ ìš©ë„ |
|-----------|------|------|-----------|
| **PyPDF2** | - ì„¤ì¹˜ ê°„ë‹¨<br>- ê¸°ë³¸ ê¸°ëŠ¥ ì¶©ì‹¤<br>- ë¬¸ì„œ ì¡°ì‘ ê°€ëŠ¥ | - ë³µì¡í•œ PDF ì²˜ë¦¬ í•œê³„<br>- í…Œì´ë¸” ì¶”ì¶œ ë¯¸ì§€ì› | ë‹¨ìˆœ í…ìŠ¤íŠ¸ ì¶”ì¶œ, PDF ë³‘í•©/ë¶„í•  |
| **pdfplumber** | - í…Œì´ë¸” ì¶”ì¶œ ê°•ë ¥<br>- ì¢Œí‘œ ê¸°ë°˜ ì •ë°€ ì¶”ì¶œ<br>- ì‹œê°í™” ê¸°ëŠ¥ | - ì†ë„ê°€ ëŠë¦¼<br>- ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ë¶€ë‹´ | í…Œì´ë¸” ë°ì´í„° ì¶”ì¶œ, ì •ë°€í•œ ë ˆì´ì•„ì›ƒ ë¶„ì„ |
| **PyMuPDF (fitz)** | - ë§¤ìš° ë¹ ë¥¸ ì†ë„<br>- ì´ë¯¸ì§€ ì¶”ì¶œ ìš°ìˆ˜<br>- PDF ë Œë”ë§ ê°€ëŠ¥ | - ì„¤ì¹˜ ìš©ëŸ‰ í¼<br>- í•™ìŠµ ê³¡ì„  | ëŒ€ìš©ëŸ‰ PDF, ì´ë¯¸ì§€ ì¶”ì¶œ, ê³ ì„±ëŠ¥ ìš”êµ¬ |
| **pdfminer.six** | - ì €ìˆ˜ì¤€ API<br>- ì„¸ë°€í•œ ì œì–´ ê°€ëŠ¥ | - ì‚¬ìš©ë²• ë³µì¡<br>- ë¬¸ì„œ ë¶€ì¡± | ê³ ê¸‰ ì‚¬ìš©ì, ì»¤ìŠ¤í…€ íŒŒì„œ ê°œë°œ |
| **tabula-py** | - í…Œì´ë¸” ì¶”ì¶œ íŠ¹í™”<br>- Pandas í†µí•© | - Java ì˜ì¡´ì„±<br>- í…Œì´ë¸”ë§Œ ì§€ì› | í…Œì´ë¸” ì¤‘ì‹¬ ë¬¸ì„œ |
| **camelot-py** | - í…Œì´ë¸” ì¶”ì¶œ ìµœìƒê¸‰<br>- ì •í™•ë„ ë†’ìŒ | - ì„¤ì¹˜ ë³µì¡<br>- Ghostscript í•„ìš” | ë³µì¡í•œ í…Œì´ë¸” êµ¬ì¡° |

### ì„¤ì¹˜ ë°©ë²•

#### ê¸°ë³¸ ì„¤ì¹˜

```bash
# í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•œ ë²ˆì— ì„¤ì¹˜ (ê¶Œì¥)
pip install PyPDF2 pdfplumber reportlab PyMuPDF

# ë˜ëŠ” ê°œë³„ ì„¤ì¹˜
pip install PyPDF2        # ê¸°ë³¸ PDF ì²˜ë¦¬
pip install pdfplumber    # í…Œì´ë¸” ì¶”ì¶œ
pip install PyMuPDF       # ê³ ì„±ëŠ¥ ì²˜ë¦¬
pip install reportlab     # PDF ìƒì„± (ìƒ˜í”Œ íŒŒì¼ìš©)
```

#### âš ï¸ ì¤‘ìš”: PyPDF2 ë²„ì „ ì´ìŠˆ

**PyPDF2 ë²„ì „ì— ë”°ë¼ import ë°©ë²•ì´ ë‹¤ë¦…ë‹ˆë‹¤:**

```python
# PyPDF2 3.x ë²„ì „ (ìµœì‹ )
from pypdf import PdfReader, PdfWriter, PdfMerger

# PyPDF2 2.x ë²„ì „ (êµ¬ë²„ì „)
from PyPDF2 import PdfReader, PdfWriter, PdfMerger
```

**ë²„ì „ í˜¸í™˜ì„± ì½”ë“œ (ê¶Œì¥):**

```python
# ì–‘ìª½ ë²„ì „ ëª¨ë‘ ì§€ì›
try:
    from pypdf import PdfReader, PdfWriter, PdfMerger
    print("âœ… pypdf (PyPDF2 3.x) ì‚¬ìš©")
except ImportError:
    from PyPDF2 import PdfReader, PdfWriter, PdfMerger
    print("âœ… PyPDF2 2.x ì‚¬ìš©")
```

#### ì„¤ì¹˜ í™•ì¸

```bash
# Pythonì—ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸
python -c "import pypdf; print(f'PyPDF2 ë²„ì „: {pypdf.__version__}')"
python -c "import pdfplumber; print('pdfplumber ì„¤ì¹˜ ì™„ë£Œ')"
python -c "import fitz; print('PyMuPDF ì„¤ì¹˜ ì™„ë£Œ')"
```

### ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ì •ë³´

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ìµœì‹  ë²„ì „ | ì£¼ìš” ë³€ê²½ì‚¬í•­ |
|-----------|----------|--------------|
| PyPDF2 | 3.0+ | ëª¨ë“ˆëª…ì´ `PyPDF2`ì—ì„œ `pypdf`ë¡œ ë³€ê²½ |
| pdfplumber | 0.11+ | ì•ˆì •ì ì¸ í…Œì´ë¸” ì¶”ì¶œ |
| PyMuPDF | 1.24+ | ì„±ëŠ¥ ìµœì í™” |
| reportlab | 4.0+ | Python 3.10+ ì§€ì› |

### ì„ íƒì  ì„¤ì¹˜ (ê³ ê¸‰ ê¸°ëŠ¥)

# pdfminer.six (ì €ìˆ˜ì¤€)
pip install pdfminer.six

# tabula-py (í…Œì´ë¸” íŠ¹í™”)
pip install tabula-py

# camelot-py (í…Œì´ë¸” ì „ë¬¸)
pip install camelot-py[cv]  # OpenCV í¬í•¨
```

---

## 4. PyPDF2ë¥¼ ì´ìš©í•œ ê¸°ë³¸ íŒŒì‹±

### 4.1 PDF íŒŒì¼ ì—´ê¸° ë° ì •ë³´ ì¶”ì¶œ

```python
import PyPDF2

def extract_pdf_info(pdf_path):
    """
    PDF ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
    """
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)

        # ê¸°ë³¸ ì •ë³´
        num_pages = len(reader.pages)
        metadata = reader.metadata

        print(f"ğŸ“„ í˜ì´ì§€ ìˆ˜: {num_pages}")
        print(f"ğŸ“ ì œëª©: {metadata.title}")
        print(f"ğŸ‘¤ ì‘ì„±ì: {metadata.author}")
        print(f"ğŸ“… ìƒì„±ì¼: {metadata.creation_date}")

        return {
            'num_pages': num_pages,
            'metadata': metadata
        }

# ì‚¬ìš© ì˜ˆì‹œ
info = extract_pdf_info('document.pdf')
```

### 4.2 í…ìŠ¤íŠ¸ ì¶”ì¶œ

```python
def extract_text_pypdf2(pdf_path):
    """
    PDFì—ì„œ ì „ì²´ í…ìŠ¤íŠ¸ ì¶”ì¶œ
    """
    text_content = []

    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)

        # ëª¨ë“  í˜ì´ì§€ ìˆœíšŒ
        for page_num, page in enumerate(reader.pages, start=1):
            # í˜ì´ì§€ì—ì„œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
            text = page.extract_text()

            text_content.append({
                'page': page_num,
                'text': text
            })

            print(f"í˜ì´ì§€ {page_num}: {len(text)}ì ì¶”ì¶œ")

    return text_content

# ì‚¬ìš© ì˜ˆì‹œ
content = extract_text_pypdf2('document.pdf')

# ì „ì²´ í…ìŠ¤íŠ¸ ê²°í•©
full_text = '\n'.join(page['text'] for page in content)
print(full_text)
```

### 4.3 PDF íŒŒì¼ ì¡°ì‘

```python
def merge_pdfs(pdf_list, output_path):
    """
    ì—¬ëŸ¬ PDF íŒŒì¼ì„ í•˜ë‚˜ë¡œ ë³‘í•©
    """
    merger = PyPDF2.PdfMerger()

    for pdf in pdf_list:
        merger.append(pdf)

    merger.write(output_path)
    merger.close()

    print(f"âœ… PDF ë³‘í•© ì™„ë£Œ: {output_path}")

def split_pdf(pdf_path, output_dir):
    """
    PDFë¥¼ í˜ì´ì§€ë³„ë¡œ ë¶„í• 
    """
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)

        for page_num, page in enumerate(reader.pages, start=1):
            writer = PyPDF2.PdfWriter()
            writer.add_page(page)

            output_file = f"{output_dir}/page_{page_num}.pdf"
            with open(output_file, 'wb') as output:
                writer.write(output)

            print(f"í˜ì´ì§€ {page_num} ì €ì¥: {output_file}")

# ì‚¬ìš© ì˜ˆì‹œ
merge_pdfs(['doc1.pdf', 'doc2.pdf'], 'merged.pdf')
split_pdf('document.pdf', 'output')
```

---

## 5. pdfplumberë¥¼ ì´ìš©í•œ ê³ ê¸‰ íŒŒì‹±

### 5.1 ì •ë°€í•œ í…ìŠ¤íŠ¸ ì¶”ì¶œ

```python
import pdfplumber

def extract_text_pdfplumber(pdf_path):
    """
    pdfplumberë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ (ë ˆì´ì•„ì›ƒ ì •ë³´ í¬í•¨)
    """
    with pdfplumber.open(pdf_path) as pdf:
        for page_num, page in enumerate(pdf.pages, start=1):
            # í…ìŠ¤íŠ¸ ì¶”ì¶œ
            text = page.extract_text()

            # í˜ì´ì§€ í¬ê¸° ì •ë³´
            width = page.width
            height = page.height

            print(f"\ní˜ì´ì§€ {page_num} ({width}x{height}):")
            print(text)

            # ë‹¨ì–´ ë‹¨ìœ„ë¡œ ì¶”ì¶œ (ì¢Œí‘œ í¬í•¨)
            words = page.extract_words()
            print(f"\në‹¨ì–´ ìˆ˜: {len(words)}")

            # ì²« 5ê°œ ë‹¨ì–´ì˜ ì¢Œí‘œ ì¶œë ¥
            for word in words[:5]:
                print(f"  '{word['text']}' at ({word['x0']}, {word['top']})")

# ì‚¬ìš© ì˜ˆì‹œ
extract_text_pdfplumber('document.pdf')
```

### 5.2 ì˜ì—­ ê¸°ë°˜ ì¶”ì¶œ

```python
def extract_text_from_region(pdf_path, page_num, bbox):
    """
    íŠ¹ì • ì˜ì—­ì—ì„œë§Œ í…ìŠ¤íŠ¸ ì¶”ì¶œ

    Args:
        bbox (tuple): (x0, y0, x1, y1) ì¢Œí‘œ
    """
    with pdfplumber.open(pdf_path) as pdf:
        page = pdf.pages[page_num - 1]

        # ì˜ì—­ ì˜ë¼ë‚´ê¸°
        cropped = page.within_bbox(bbox)

        # í…ìŠ¤íŠ¸ ì¶”ì¶œ
        text = cropped.extract_text()

        print(f"ì˜ì—­ {bbox}ì—ì„œ ì¶”ì¶œ:")
        print(text)

        return text

# ì‚¬ìš© ì˜ˆì‹œ (ì™¼ìª½ ìƒë‹¨ 100x100 ì˜ì—­)
text = extract_text_from_region('document.pdf', page_num=1, bbox=(0, 0, 100, 100))
```

---

## 6. í…Œì´ë¸” ë°ì´í„° ì¶”ì¶œ

### 6.1 pdfplumberë¥¼ ì´ìš©í•œ í…Œì´ë¸” ì¶”ì¶œ

```python
import pdfplumber
import pandas as pd

def extract_tables_pdfplumber(pdf_path):
    """
    PDFì—ì„œ í…Œì´ë¸” ì¶”ì¶œ ë° DataFrameìœ¼ë¡œ ë³€í™˜
    """
    all_tables = []

    with pdfplumber.open(pdf_path) as pdf:
        for page_num, page in enumerate(pdf.pages, start=1):
            # í˜ì´ì§€ì—ì„œ í…Œì´ë¸” ì¶”ì¶œ
            tables = page.extract_tables()

            if tables:
                print(f"\ní˜ì´ì§€ {page_num}: {len(tables)}ê°œ í…Œì´ë¸” ë°œê²¬")

                for table_num, table in enumerate(tables, start=1):
                    # pandas DataFrameìœ¼ë¡œ ë³€í™˜
                    df = pd.DataFrame(table[1:], columns=table[0])

                    print(f"\ní…Œì´ë¸” {table_num}:")
                    print(df)

                    all_tables.append({
                        'page': page_num,
                        'table_num': table_num,
                        'dataframe': df
                    })

    return all_tables

# ì‚¬ìš© ì˜ˆì‹œ
tables = extract_tables_pdfplumber('report.pdf')

# ì²« ë²ˆì§¸ í…Œì´ë¸” CSVë¡œ ì €ì¥
if tables:
    tables[0]['dataframe'].to_csv('table_1.csv', index=False)
```

### 6.2 í…Œì´ë¸” ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•

```python
def extract_tables_custom_settings(pdf_path):
    """
    í…Œì´ë¸” ê°ì§€ ì„¤ì •ì„ ì¡°ì •í•˜ì—¬ ì¶”ì¶œ
    """
    table_settings = {
        "vertical_strategy": "lines",      # ì„¸ë¡œ êµ¬ë¶„ì„  ê°ì§€ ì „ëµ
        "horizontal_strategy": "lines",    # ê°€ë¡œ êµ¬ë¶„ì„  ê°ì§€ ì „ëµ
        "explicit_vertical_lines": [],     # ëª…ì‹œì  ì„¸ë¡œì„ 
        "explicit_horizontal_lines": [],   # ëª…ì‹œì  ê°€ë¡œì„ 
        "snap_tolerance": 3,               # ì„  ìŠ¤ëƒ… í—ˆìš© ì˜¤ì°¨
        "join_tolerance": 3,               # ì„  ê²°í•© í—ˆìš© ì˜¤ì°¨
        "edge_min_length": 3,              # ìµœì†Œ ì„  ê¸¸ì´
        "min_words_vertical": 3,           # ì„¸ë¡œ ë°©í–¥ ìµœì†Œ ë‹¨ì–´ ìˆ˜
        "min_words_horizontal": 1,         # ê°€ë¡œ ë°©í–¥ ìµœì†Œ ë‹¨ì–´ ìˆ˜
    }

    with pdfplumber.open(pdf_path) as pdf:
        for page in pdf.pages:
            # ì»¤ìŠ¤í…€ ì„¤ì •ìœ¼ë¡œ í…Œì´ë¸” ì¶”ì¶œ
            tables = page.extract_tables(table_settings)

            for table in tables:
                df = pd.DataFrame(table[1:], columns=table[0])
                print(df)

# ì‚¬ìš© ì˜ˆì‹œ
extract_tables_custom_settings('complex_table.pdf')
```

### 6.3 tabula-pyë¥¼ ì´ìš©í•œ í…Œì´ë¸” ì¶”ì¶œ

```python
import tabula

def extract_tables_tabula(pdf_path):
    """
    tabula-pyë¡œ í…Œì´ë¸” ì¶”ì¶œ (Java ê¸°ë°˜)
    """
    # ë°©ë²• 1: ëª¨ë“  í…Œì´ë¸”ì„ ë¦¬ìŠ¤íŠ¸ë¡œ
    tables = tabula.read_pdf(
        pdf_path,
        pages='all',
        multiple_tables=True,
        lattice=True  # ì„ ìœ¼ë¡œ êµ¬ë¶„ëœ í…Œì´ë¸”
    )

    for i, table in enumerate(tables, start=1):
        print(f"\ní…Œì´ë¸” {i}:")
        print(table)

    # ë°©ë²• 2: ì§ì ‘ DataFrameìœ¼ë¡œ
    df = tabula.read_pdf(
        pdf_path,
        pages='1',
        area=[50, 50, 500, 500],  # (y1, x1, y2, x2) ì˜ì—­ ì§€ì •
        columns=[100, 200, 300]    # ì»¬ëŸ¼ êµ¬ë¶„ì„ 
    )[0]

    print("\nì˜ì—­ ì§€ì • ì¶”ì¶œ:")
    print(df)

    return tables

# ì‚¬ìš© ì˜ˆì‹œ
tables = extract_tables_tabula('financial_report.pdf')
```

---

## 7. ì´ë¯¸ì§€ ë° ë©”íƒ€ë°ì´í„° ì¶”ì¶œ

### 7.1 PyMuPDFë¥¼ ì´ìš©í•œ ì´ë¯¸ì§€ ì¶”ì¶œ

```python
import fitz  # PyMuPDF
from PIL import Image
import io

def extract_images_pymupdf(pdf_path, output_dir):
    """
    PDFì—ì„œ ì´ë¯¸ì§€ ì¶”ì¶œ
    """
    import os
    os.makedirs(output_dir, exist_ok=True)

    pdf_document = fitz.open(pdf_path)

    image_count = 0

    for page_num in range(len(pdf_document)):
        page = pdf_document[page_num]

        # í˜ì´ì§€ì—ì„œ ì´ë¯¸ì§€ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        images = page.get_images(full=True)

        print(f"í˜ì´ì§€ {page_num + 1}: {len(images)}ê°œ ì´ë¯¸ì§€")

        for img_index, img in enumerate(images):
            xref = img[0]  # ì´ë¯¸ì§€ ì°¸ì¡° ë²ˆí˜¸

            # ì´ë¯¸ì§€ ë°ì´í„° ì¶”ì¶œ
            base_image = pdf_document.extract_image(xref)
            image_bytes = base_image["image"]
            image_ext = base_image["ext"]

            # ì´ë¯¸ì§€ ì €ì¥
            image_count += 1
            image_filename = f"{output_dir}/image_{page_num + 1}_{img_index + 1}.{image_ext}"

            with open(image_filename, "wb") as img_file:
                img_file.write(image_bytes)

            print(f"  ì €ì¥: {image_filename}")

    pdf_document.close()
    print(f"\nâœ… ì´ {image_count}ê°œ ì´ë¯¸ì§€ ì¶”ì¶œ ì™„ë£Œ")

# ì‚¬ìš© ì˜ˆì‹œ
extract_images_pymupdf('document.pdf', 'extracted_images')
```

### 7.2 ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ë° ìˆ˜ì •

```python
def extract_metadata(pdf_path):
    """
    PDF ë©”íƒ€ë°ì´í„° ìƒì„¸ ì¶”ì¶œ
    """
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)
        metadata = reader.metadata

        print("ğŸ“‹ PDF ë©”íƒ€ë°ì´í„°:")
        print(f"  ì œëª©: {metadata.get('/Title', 'N/A')}")
        print(f"  ì‘ì„±ì: {metadata.get('/Author', 'N/A')}")
        print(f"  ì£¼ì œ: {metadata.get('/Subject', 'N/A')}")
        print(f"  í‚¤ì›Œë“œ: {metadata.get('/Keywords', 'N/A')}")
        print(f"  ìƒì„± í”„ë¡œê·¸ë¨: {metadata.get('/Creator', 'N/A')}")
        print(f"  PDF ìƒì„±ê¸°: {metadata.get('/Producer', 'N/A')}")
        print(f"  ìƒì„±ì¼: {metadata.get('/CreationDate', 'N/A')}")
        print(f"  ìˆ˜ì •ì¼: {metadata.get('/ModDate', 'N/A')}")

        return metadata

def add_metadata(input_pdf, output_pdf, metadata_dict):
    """
    PDFì— ë©”íƒ€ë°ì´í„° ì¶”ê°€/ìˆ˜ì •
    """
    reader = PyPDF2.PdfReader(input_pdf)
    writer = PyPDF2.PdfWriter()

    # ëª¨ë“  í˜ì´ì§€ ë³µì‚¬
    for page in reader.pages:
        writer.add_page(page)

    # ë©”íƒ€ë°ì´í„° ì¶”ê°€
    writer.add_metadata(metadata_dict)

    # ì €ì¥
    with open(output_pdf, 'wb') as output:
        writer.write(output)

    print(f"âœ… ë©”íƒ€ë°ì´í„° ì¶”ê°€ ì™„ë£Œ: {output_pdf}")

# ì‚¬ìš© ì˜ˆì‹œ
metadata = extract_metadata('document.pdf')

new_metadata = {
    '/Title': 'ìƒˆë¡œìš´ ì œëª©',
    '/Author': 'í™ê¸¸ë™',
    '/Subject': 'ë¬¸ì„œ ì£¼ì œ',
    '/Keywords': 'Python, PDF, íŒŒì‹±'
}
add_metadata('document.pdf', 'document_with_metadata.pdf', new_metadata)
```

---

## 8. ì‹¤ìŠµ ì˜ˆì œ

ì‹¤ìŠµ ì˜ˆì œëŠ” `ì‹¤ìŠµ/pdf_parsing/` ë””ë ‰í† ë¦¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **[ê¸°ë³¸ PDF íŒŒì„œ](ì‹¤ìŠµ/pdf_parsing/01_basic_pdf_parser.py)**: PyPDF2 ê¸°ë³¸ ì‚¬ìš©ë²•
2. **[í…ìŠ¤íŠ¸ ì¶”ì¶œê¸°](ì‹¤ìŠµ/pdf_parsing/02_text_extractor.py)**: ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
3. **[í…Œì´ë¸” ì¶”ì¶œê¸°](ì‹¤ìŠµ/pdf_parsing/03_table_extractor.py)**: pdfplumberë¡œ í…Œì´ë¸” ì¶”ì¶œ
4. **[ì´ë¯¸ì§€ ì¶”ì¶œê¸°](ì‹¤ìŠµ/pdf_parsing/04_image_extractor.py)**: PyMuPDFë¡œ ì´ë¯¸ì§€ ì¶”ì¶œ
5. **[í†µí•© ì˜ˆì œ](ì‹¤ìŠµ/pdf_parsing/05_comprehensive_pdf_parser.py)**: ì‹¤ì „ PDF íŒŒì‹±

### í…ŒìŠ¤íŠ¸ ë°ì´í„°

- [ìƒ˜í”Œ PDF ìƒì„±ê¸°](ì‹¤ìŠµ/pdf_parsing/generate_sample_pdf.py)
- [í…Œì´ë¸” í¬í•¨ PDF](ì‹¤ìŠµ/pdf_parsing/data/sample_table.pdf)
- [ì´ë¯¸ì§€ í¬í•¨ PDF](ì‹¤ìŠµ/pdf_parsing/data/sample_with_images.pdf)

---

## 9. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 9.1 í…ìŠ¤íŠ¸ ì¶”ì¶œ ë¬¸ì œ

#### ë¬¸ì œ: í…ìŠ¤íŠ¸ê°€ ê¹¨ì§€ê±°ë‚˜ ìˆœì„œê°€ ë’¤ì£½ë°•ì£½

```python
# âŒ ë¬¸ì œ ìƒí™©
text = page.extract_text()
# ì¶œë ¥: "ì•ˆë…•í•˜ì„¸ìš” ë¦„ì €ì œ ì€"

# âœ… í•´ê²° ë°©ë²• 1: pdfplumber ì‚¬ìš©
import pdfplumber
with pdfplumber.open('document.pdf') as pdf:
    text = pdf.pages[0].extract_text()

# âœ… í•´ê²° ë°©ë²• 2: layout ëª¨ë“œ ì‚¬ìš©
from pdfminer.high_level import extract_text_to_fp
from pdfminer.layout import LAParams

laparams = LAParams()
with open('document.pdf', 'rb') as fp:
    extract_text_to_fp(fp, output, laparams=laparams)
```

#### ë¬¸ì œ: í•œê¸€ì´ ì¶”ì¶œë˜ì§€ ì•ŠìŒ

```python
# ì›ì¸: í°íŠ¸ ì„ë² ë”© ë¬¸ì œ ë˜ëŠ” ì´ë¯¸ì§€ ê¸°ë°˜ PDF

# âœ… í•´ê²° ë°©ë²•: OCR ì‚¬ìš©
import pytesseract
from pdf2image import convert_from_path

# PDFë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜
images = convert_from_path('document.pdf')

# OCRë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
for i, image in enumerate(images):
    text = pytesseract.image_to_string(image, lang='kor+eng')
    print(f"í˜ì´ì§€ {i+1}:\n{text}")
```

### 9.2 ì•”í˜¸í™”ëœ PDF ì²˜ë¦¬

```python
def decrypt_pdf(pdf_path, password):
    """
    ì•”í˜¸í™”ëœ PDF ì—´ê¸°
    """
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)

        # ì•”í˜¸í™” ì—¬ë¶€ í™•ì¸
        if reader.is_encrypted:
            # ë¹„ë°€ë²ˆí˜¸ë¡œ í•´ë… ì‹œë„
            if reader.decrypt(password):
                print("âœ… PDF ì ê¸ˆ í•´ì œ ì„±ê³µ")

                # í…ìŠ¤íŠ¸ ì¶”ì¶œ
                text = reader.pages[0].extract_text()
                return text
            else:
                print("âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë¦½ë‹ˆë‹¤")
                return None
        else:
            print("ğŸ”“ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ PDFì…ë‹ˆë‹¤")

# ì‚¬ìš© ì˜ˆì‹œ
text = decrypt_pdf('encrypted.pdf', 'password123')
```

### 9.3 í…Œì´ë¸” ì¶”ì¶œ ì‹¤íŒ¨

```python
# ë¬¸ì œ: í…Œì´ë¸”ì´ ê°ì§€ë˜ì§€ ì•ŠìŒ

# âœ… í•´ê²° ë°©ë²• 1: í…Œì´ë¸” ì„¤ì • ì¡°ì •
table_settings = {
    "vertical_strategy": "text",  # "lines" ëŒ€ì‹  "text" ì‚¬ìš©
    "horizontal_strategy": "text",
    "intersection_tolerance": 15,
}

tables = page.extract_tables(table_settings)

# âœ… í•´ê²° ë°©ë²• 2: camelot ì‚¬ìš© (ë” ê°•ë ¥)
import camelot

tables = camelot.read_pdf('document.pdf', pages='1', flavor='lattice')
print(tables[0].df)  # DataFrame ì¶œë ¥
```

### 9.4 ë©”ëª¨ë¦¬ ë¬¸ì œ

```python
# ë¬¸ì œ: ëŒ€ìš©ëŸ‰ PDF ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ ë¶€ì¡±

# âœ… í•´ê²° ë°©ë²•: í˜ì´ì§€ë³„ ì²˜ë¦¬ ë° ë©”ëª¨ë¦¬ í•´ì œ
import gc

def process_large_pdf(pdf_path):
    with pdfplumber.open(pdf_path) as pdf:
        total_pages = len(pdf.pages)

        for i in range(total_pages):
            # í•œ í˜ì´ì§€ì”© ì²˜ë¦¬
            page = pdf.pages[i]
            text = page.extract_text()

            # ì²˜ë¦¬ ì‘ì—… ìˆ˜í–‰
            process_text(text)

            # ëª…ì‹œì  ë©”ëª¨ë¦¬ í•´ì œ
            if i % 10 == 0:
                gc.collect()
                print(f"ì§„í–‰ë¥ : {i/total_pages*100:.1f}%")

# ì‚¬ìš© ì˜ˆì‹œ
process_large_pdf('large_document.pdf')
```

### 9.5 ì¢Œí‘œ ì‹œìŠ¤í…œ ì´í•´

```python
"""
PDF ì¢Œí‘œ ì‹œìŠ¤í…œ:
- ì›ì (0,0)ì€ ì™¼ìª½ í•˜ë‹¨
- xëŠ” ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì¦ê°€
- yëŠ” ìœ„ìª½ìœ¼ë¡œ ì¦ê°€

pdfplumber ì¢Œí‘œ:
- ì›ì (0,0)ì€ ì™¼ìª½ ìƒë‹¨
- xëŠ” ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì¦ê°€
- yëŠ” ì•„ë˜ìª½ìœ¼ë¡œ ì¦ê°€
"""

def convert_coordinates(page_height, y_from_bottom):
    """
    PDF ì¢Œí‘œë¥¼ pdfplumber ì¢Œí‘œë¡œ ë³€í™˜
    """
    y_from_top = page_height - y_from_bottom
    return y_from_top
```

---

## 10. ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

### âœ… PDF íŒŒì‹± ì„¤ê³„ ì›ì¹™

1. **ì ì ˆí•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ**
   ```python
   # ë‹¨ìˆœ í…ìŠ¤íŠ¸ ì¶”ì¶œ â†’ PyPDF2
   # í…Œì´ë¸” ì¶”ì¶œ â†’ pdfplumber ë˜ëŠ” tabula
   # ê³ ì„±ëŠ¥ í•„ìš” â†’ PyMuPDF
   # ì´ë¯¸ì§€ ê¸°ë°˜ PDF â†’ pytesseract (OCR)
   ```

2. **ì—ëŸ¬ ì²˜ë¦¬**
   ```python
   def safe_extract_text(pdf_path):
       try:
           with pdfplumber.open(pdf_path) as pdf:
               return pdf.pages[0].extract_text()
       except Exception as e:
           print(f"ì˜¤ë¥˜: {e}")
           return None
   ```

3. **ë©”ëª¨ë¦¬ ê´€ë¦¬**
   ```python
   # âœ… ê¶Œì¥: with êµ¬ë¬¸ ì‚¬ìš©
   with pdfplumber.open(pdf_path) as pdf:
       text = pdf.pages[0].extract_text()

   # âŒ ë¹„ê¶Œì¥: ìˆ˜ë™ ë‹«ê¸°
   pdf = pdfplumber.open(pdf_path)
   text = pdf.pages[0].extract_text()
   pdf.close()
   ```

4. **ê²°ê³¼ ê²€ì¦**
   ```python
   def validate_extraction(text):
       """
       ì¶”ì¶œëœ í…ìŠ¤íŠ¸ ê²€ì¦
       """
       if not text or len(text) < 10:
           print("âš ï¸  ì¶”ì¶œëœ í…ìŠ¤íŠ¸ê°€ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤")
           return False

       # ê¹¨ì§„ ë¬¸ì í™•ì¸
       if 'ï¿½' in text or text.count('\\ufffd') > 0:
           print("âš ï¸  ê¹¨ì§„ ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤")
           return False

       return True
   ```

5. **ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§**
   ```python
   import logging

   logging.basicConfig(level=logging.INFO)
   logger = logging.getLogger(__name__)

   def extract_with_logging(pdf_path):
       logger.info(f"PDF íŒŒì‹± ì‹œì‘: {pdf_path}")

       try:
           with pdfplumber.open(pdf_path) as pdf:
               logger.info(f"ì´ í˜ì´ì§€ ìˆ˜: {len(pdf.pages)}")

               for i, page in enumerate(pdf.pages, 1):
                   text = page.extract_text()
                   logger.info(f"í˜ì´ì§€ {i}: {len(text)}ì ì¶”ì¶œ")

           logger.info("PDF íŒŒì‹± ì™„ë£Œ")

       except Exception as e:
           logger.error(f"PDF íŒŒì‹± ì‹¤íŒ¨: {e}")
   ```

### ğŸš« í”¼í•´ì•¼ í•  ì‚¬í•­

- âŒ ëª¨ë“  í˜ì´ì§€ë¥¼ í•œ ë²ˆì— ë©”ëª¨ë¦¬ì— ë¡œë“œ
- âŒ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„± ë¯¸í™•ì¸ (Java, Ghostscript ë“±)
- âŒ í…ìŠ¤íŠ¸ ì¶”ì¶œ ì‹¤íŒ¨ ì‹œ ëŒ€ì•ˆ ì—†ìŒ
- âŒ ì•”í˜¸í™”/ê¶Œí•œ í™•ì¸ ì—†ì´ ì²˜ë¦¬
- âŒ ì¢Œí‘œ ì‹œìŠ¤í…œ ì°¨ì´ ë¬´ì‹œ

### ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

| ê¸°ë²• | ì„¤ëª… | ì ìš© ì‹œì  |
|------|------|-----------|
| **í˜ì´ì§€ë³„ ì²˜ë¦¬** | í•œ í˜ì´ì§€ì”© ì²˜ë¦¬í•˜ì—¬ ë©”ëª¨ë¦¬ ì ˆì•½ | ëŒ€ìš©ëŸ‰ PDF |
| **ë³‘ë ¬ ì²˜ë¦¬** | ë©€í‹°í”„ë¡œì„¸ì‹±ìœ¼ë¡œ ì†ë„ í–¥ìƒ | ì—¬ëŸ¬ PDF íŒŒì¼ |
| **ìºì‹±** | ë°˜ë³µ ì ‘ê·¼í•˜ëŠ” ë°ì´í„° ìºì‹± | ë™ì¼ PDF ì¬ì²˜ë¦¬ |
| **ì„ íƒì  ì¶”ì¶œ** | í•„ìš”í•œ ì˜ì—­ë§Œ ì¶”ì¶œ | íŠ¹ì • ì˜ì—­ ë°ì´í„° |
| **ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ** | ì‘ì—…ì— ë§ëŠ” ìµœì  ë¼ì´ë¸ŒëŸ¬ë¦¬ | í•­ìƒ |

```python
# ì„±ëŠ¥ ì¸¡ì • ì˜ˆì‹œ
import time

def benchmark_pdf_extraction(pdf_path):
    """
    ë‹¤ì–‘í•œ ë°©ë²•ì˜ ì„±ëŠ¥ ë¹„êµ
    """
    # PyPDF2
    start = time.time()
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)
        text1 = reader.pages[0].extract_text()
    time1 = time.time() - start

    # pdfplumber
    start = time.time()
    with pdfplumber.open(pdf_path) as pdf:
        text2 = pdf.pages[0].extract_text()
    time2 = time.time() - start

    # PyMuPDF
    start = time.time()
    doc = fitz.open(pdf_path)
    text3 = doc[0].get_text()
    doc.close()
    time3 = time.time() - start

    print(f"PyPDF2:     {time1:.3f}ì´ˆ")
    print(f"pdfplumber: {time2:.3f}ì´ˆ")
    print(f"PyMuPDF:    {time3:.3f}ì´ˆ")
```

---

## âœ… ìš”ì•½

| êµ¬ë¶„ | ë‚´ìš© |
|------|------|
| **ê¸°ë³¸ ë¼ì´ë¸ŒëŸ¬ë¦¬** | PyPDF2 (ê¸°ë³¸), pdfplumber (í…Œì´ë¸”), PyMuPDF (ê³ ì„±ëŠ¥) |
| **ì£¼ìš” ê¸°ëŠ¥** | í…ìŠ¤íŠ¸ ì¶”ì¶œ, í…Œì´ë¸” ì¶”ì¶œ, ì´ë¯¸ì§€ ì¶”ì¶œ, ë©”íƒ€ë°ì´í„° ì²˜ë¦¬ |
| **íŠ¹ìˆ˜ ì²˜ë¦¬** | OCR (pytesseract), ì•”í˜¸í™” (decrypt), ëŒ€ìš©ëŸ‰ (í˜ì´ì§€ë³„) |
| **ì£¼ì˜ì‚¬í•­** | ì¢Œí‘œ ì‹œìŠ¤í…œ, ë©”ëª¨ë¦¬ ê´€ë¦¬, ì¸ì½”ë”© ë¬¸ì œ, í°íŠ¸ ì„ë² ë”© |
| **ì„±ëŠ¥** | PyMuPDF > PyPDF2 > pdfplumber (í…Œì´ë¸” ì œì™¸) |

---

## ğŸ“š ì°¸ê³  ìë£Œ

### Python ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì„œ
- [PyPDF2 Documentation](https://pypdf2.readthedocs.io/)
- [pdfplumber Documentation](https://github.com/jsvine/pdfplumber)
- [PyMuPDF Documentation](https://pymupdf.readthedocs.io/)
- [tabula-py Documentation](https://tabula-py.readthedocs.io/)
- [camelot Documentation](https://camelot-py.readthedocs.io/)

### PDF ìŠ¤í™ ë° ê°€ì´ë“œ
- [PDF Reference (Adobe)](https://www.adobe.com/devnet/pdf/pdf_reference.html)
- [PDF 1.7 Specification (ISO 32000)](https://www.iso.org/standard/51502.html)

### ì˜¨ë¼ì¸ ë¦¬ì†ŒìŠ¤
- [Real Python - Working with PDFs in Python](https://realpython.com/pdf-python/)
- [DataCamp - Reading PDFs in Python](https://www.datacamp.com/tutorial/reading-pdfs-in-python)

### OCR ê´€ë ¨
- [Tesseract OCR](https://github.com/tesseract-ocr/tesseract)
- [pytesseract](https://pypi.org/project/pytesseract/)
- [pdf2image](https://pypi.org/project/pdf2image/)

---

## ğŸ“Œ ë‹¤ìŒ ë‹¨ê³„

PDF íŒŒì‹±ì„ ìµí˜”ë‹¤ë©´, ë‹¤ìŒì€ **ì²­ì»¤(Chunker) ë§Œë“¤ê¸°**ì…ë‹ˆë‹¤.

**ë‹¤ìŒ ë¬¸ì„œ**: [1.2.04. ë°ì´í„° ì „ì²˜ë¦¬ - ì²­ì»¤(Chunker) ë§Œë“¤ê¸° (1)](./1.2.04.ë°ì´í„°%20ì „ì²˜ë¦¬%20-%20ì²­ì»¤(Chunker)%20ë§Œë“¤ê¸°(1).md)

---

**ë¬¸ì„œ ë²„ì „**: 1.0
**ìµœì¢… ìˆ˜ì •ì¼**: 2025-10-23
**ì‘ì„±ì**: Bern
