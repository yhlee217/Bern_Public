# ê°œì„ ëœ í•œê¸€ ì§€ì› ëª¨ë¸ ì ìš© ê°€ì´ë“œ

> **ëª©ì **: ê¸°ì¡´ ì˜ì–´ ì „ìš© ëª¨ë¸ì„ í•œê¸€ ì§€ì› ë‹¤êµ­ì–´ ëª¨ë¸ë¡œ ë³€ê²½í•˜ëŠ” ë°©ë²•

---

## ğŸ¯ ê°œì„  ëª¨ë¸ ì ìš© ë°©ë²•

### ë°©ë²• 1: main.py ìˆ˜ì • (ê¶Œì¥)

ê¸°ì¡´ ì½”ë“œë¥¼ ê±´ë“œë¦¬ì§€ ì•Šê³  importë§Œ ë³€ê²½í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

**íŒŒì¼**: `ì‹¤ìŠµê²°ê³¼/src/main.py`

```python
# ê¸°ì¡´ ì½”ë“œ (10ë²ˆì§¸ ì¤„)
from models.sentiment_model import SentimentModel

# ë³€ê²½ í›„
from models.sentiment_model_improved import SentimentModelImproved as SentimentModel
```

**ì ìš© ìˆœì„œ (Windows CMD)**:

```cmd
REM 1. ì‹¤ìŠµê²°ê³¼ í´ë”ë¡œ ì´ë™
cd "Side Project\[AIì´í–‰íŒŒíŠ¸] Dockerì— AI ì„œë¹„ìŠ¤ í™˜ê²½ êµ¬ì¶•í•´ë³´ê¸°\ì‹¤ìŠµê²°ê³¼"

REM 2. main.py ë°±ì—…
copy src\main.py src\main_backup.py

REM 3. main.py ìˆ˜ì • (ë©”ëª¨ì¥ ë˜ëŠ” VS Codeë¡œ í¸ì§‘)
notepad src\main.py

REM 4. 10ë²ˆì§¸ ì¤„ì„ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½:
REM from models.sentiment_model_improved import SentimentModelImproved as SentimentModel

REM 5. ì €ì¥ í›„ ì„œë²„ ì‹¤í–‰
cd src
python main.py
```

---

### ë°©ë²• 2: íŒŒì¼ êµì²´

ê°œì„ ëœ ëª¨ë¸ì„ ê¸°ë³¸ ëª¨ë¸ë¡œ êµì²´í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

```cmd
REM 1. ì‹¤ìŠµê²°ê³¼ í´ë”ë¡œ ì´ë™
cd "Side Project\[AIì´í–‰íŒŒíŠ¸] Dockerì— AI ì„œë¹„ìŠ¤ í™˜ê²½ êµ¬ì¶•í•´ë³´ê¸°\ì‹¤ìŠµê²°ê³¼"

REM 2. ê¸°ì¡´ ëª¨ë¸ ë°±ì—…
copy src\models\sentiment_model.py src\models\sentiment_model_original.py

REM 3. ê°œì„  ëª¨ë¸ë¡œ êµì²´
copy src\models\sentiment_model_improved.py src\models\sentiment_model.py

REM 4. ì„œë²„ ì‹¤í–‰
cd src
python main.py
```

---

### ë°©ë²• 3: endpoints.py ìˆ˜ì •

API ì—”ë“œí¬ì¸íŠ¸ì—ì„œë§Œ ê°œì„  ëª¨ë¸ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

**íŒŒì¼**: `ì‹¤ìŠµê²°ê³¼/src/api/endpoints.py`

```python
# ìƒë‹¨ì— ì¶”ê°€
from models.sentiment_model_improved import SentimentModelImproved

# predict í•¨ìˆ˜ ìˆ˜ì •
@router.post("/predict", response_model=PredictResponse)
async def predict(request: PredictRequest):
    # ê°œì„  ëª¨ë¸ ì‚¬ìš© (ë‹¤êµ­ì–´ ëª¨ë“œ)
    model_improved = SentimentModelImproved(use_multilingual=True)
    result = model_improved.predict(request.text)
    return result
```

---

## ğŸš€ ì‹¤í–‰ ë° í…ŒìŠ¤íŠ¸

### 1. ì„œë²„ ì‹¤í–‰ (CMD)

```cmd
cd "Side Project\[AIì´í–‰íŒŒíŠ¸] Dockerì— AI ì„œë¹„ìŠ¤ í™˜ê²½ êµ¬ì¶•í•´ë³´ê¸°\ì‹¤ìŠµê²°ê³¼\src"
python main.py
```

**ì‹¤í–‰ ë¡œê·¸ í™•ì¸**:
```
INFO:     Started server process [12345]
INFO:     Waiting for application startup.
INFO:     Loading AI model...
INFO:     Loading model: nlptown/bert-base-multilingual-uncased-sentiment
INFO:     Multilingual mode: True
INFO:     Model loaded successfully
INFO:     Model supports: í•œê¸€/ì˜ì–´/ë‹¤êµ­ì–´
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
```

### 2. PowerShell í…ŒìŠ¤íŠ¸

**ìƒˆ PowerShell ì°½ì„ ì—´ê³ ** ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰:

#### í—¬ìŠ¤ì²´í¬
```powershell
# í—¬ìŠ¤ì²´í¬
Invoke-RestMethod -Uri "http://localhost:8000/health"
```

**ì˜ˆìƒ ì¶œë ¥**:
```
status      : healthy
timestamp   : 2025-10-26T18:00:00.000000
version     : 1.0.0
model_loaded: True
```

#### í•œê¸€ ê¸ì • í…ŒìŠ¤íŠ¸
```powershell
# í•œê¸€ ê¸ì • í…ìŠ¤íŠ¸
$body = @{
    text = "ì˜¤ëŠ˜ ì •ë§ ê¸°ë¶„ì´ ì¢‹ë‹¤!"
} | ConvertTo-Json -Compress

$result = Invoke-RestMethod -Uri "http://localhost:8000/predict" `
    -Method POST `
    -Body $body `
    -ContentType "application/json"

Write-Host "`n=== í•œê¸€ ê¸ì • í…ŒìŠ¤íŠ¸ ===" -ForegroundColor Green
Write-Host "í…ìŠ¤íŠ¸: ì˜¤ëŠ˜ ì •ë§ ê¸°ë¶„ì´ ì¢‹ë‹¤!"
Write-Host "ê°ì •: $($result.sentiment)"
Write-Host "ì‹ ë¢°ë„: $($result.confidence)"
Write-Host "ì²˜ë¦¬ì‹œê°„: $($result.processing_time)ì´ˆ"
```

**ì˜ˆìƒ ì¶œë ¥**:
```
=== í•œê¸€ ê¸ì • í…ŒìŠ¤íŠ¸ ===
í…ìŠ¤íŠ¸: ì˜¤ëŠ˜ ì •ë§ ê¸°ë¶„ì´ ì¢‹ë‹¤!
ê°ì •: positive
ì‹ ë¢°ë„: 0.92
ì²˜ë¦¬ì‹œê°„: 0.156ì´ˆ
```

#### í•œê¸€ ë¶€ì • í…ŒìŠ¤íŠ¸
```powershell
# í•œê¸€ ë¶€ì • í…ìŠ¤íŠ¸
$body = @{
    text = "ì •ë§ ìµœì•…ì˜ í•˜ë£¨ì˜€ì–´"
} | ConvertTo-Json -Compress

$result = Invoke-RestMethod -Uri "http://localhost:8000/predict" `
    -Method POST `
    -Body $body `
    -ContentType "application/json"

Write-Host "`n=== í•œê¸€ ë¶€ì • í…ŒìŠ¤íŠ¸ ===" -ForegroundColor Red
Write-Host "í…ìŠ¤íŠ¸: ì •ë§ ìµœì•…ì˜ í•˜ë£¨ì˜€ì–´"
Write-Host "ê°ì •: $($result.sentiment)"
Write-Host "ì‹ ë¢°ë„: $($result.confidence)"
```

**ì˜ˆìƒ ì¶œë ¥**:
```
=== í•œê¸€ ë¶€ì • í…ŒìŠ¤íŠ¸ ===
í…ìŠ¤íŠ¸: ì •ë§ ìµœì•…ì˜ í•˜ë£¨ì˜€ì–´
ê°ì •: negative
ì‹ ë¢°ë„: 0.88
```

#### í•œê¸€ ì¤‘ë¦½ í…ŒìŠ¤íŠ¸
```powershell
# í•œê¸€ ì¤‘ë¦½ í…ìŠ¤íŠ¸
$body = @{
    text = "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ íë¦½ë‹ˆë‹¤"
} | ConvertTo-Json -Compress

$result = Invoke-RestMethod -Uri "http://localhost:8000/predict" `
    -Method POST `
    -Body $body `
    -ContentType "application/json"

Write-Host "`n=== í•œê¸€ ì¤‘ë¦½ í…ŒìŠ¤íŠ¸ ===" -ForegroundColor Yellow
Write-Host "í…ìŠ¤íŠ¸: ì˜¤ëŠ˜ ë‚ ì”¨ê°€ íë¦½ë‹ˆë‹¤"
Write-Host "ê°ì •: $($result.sentiment)"
Write-Host "ì‹ ë¢°ë„: $($result.confidence)"
```

#### ì˜ì–´ í…ŒìŠ¤íŠ¸
```powershell
# ì˜ì–´ ê¸ì • í…ìŠ¤íŠ¸
$body = @{
    text = "I am very happy today!"
} | ConvertTo-Json -Compress

$result = Invoke-RestMethod -Uri "http://localhost:8000/predict" `
    -Method POST `
    -Body $body `
    -ContentType "application/json"

Write-Host "`n=== ì˜ì–´ ê¸ì • í…ŒìŠ¤íŠ¸ ===" -ForegroundColor Green
Write-Host "í…ìŠ¤íŠ¸: I am very happy today!"
Write-Host "ê°ì •: $($result.sentiment)"
Write-Host "ì‹ ë¢°ë„: $($result.confidence)"
```

---

## ğŸ“Š ë¹„êµ í…ŒìŠ¤íŠ¸ (ê¸°ì¡´ vs ê°œì„ )

### ì „ì²´ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ (PowerShell)

```powershell
# test-sentiment-improved.ps1
Write-Host "================================" -ForegroundColor Cyan
Write-Host "  ê°ì •ë¶„ì„ ëª¨ë¸ í…ŒìŠ¤íŠ¸" -ForegroundColor Cyan
Write-Host "================================" -ForegroundColor Cyan

$testCases = @(
    @{ text = "ì˜¤ëŠ˜ ì •ë§ ê¸°ë¶„ì´ ì¢‹ë‹¤!"; expected = "positive" }
    @{ text = "ì •ë§ ìµœì•…ì˜ í•˜ë£¨ì˜€ì–´"; expected = "negative" }
    @{ text = "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ íë¦½ë‹ˆë‹¤"; expected = "neutral" }
    @{ text = "I am very happy"; expected = "positive" }
    @{ text = "This is terrible"; expected = "negative" }
    @{ text = "The weather is okay"; expected = "neutral" }
)

$correct = 0
$total = $testCases.Count

foreach ($test in $testCases) {
    $body = @{ text = $test.text } | ConvertTo-Json -Compress

    try {
        $result = Invoke-RestMethod -Uri "http://localhost:8000/predict" `
            -Method POST `
            -Body $body `
            -ContentType "application/json"

        $match = if ($result.sentiment -eq $test.expected) {
            $correct++
            "âœ… ì •ë‹µ"
        } else {
            "âŒ ì˜¤ë‹µ"
        }

        Write-Host "`ní…ìŠ¤íŠ¸: $($test.text)" -ForegroundColor White
        Write-Host "ì˜ˆìƒ: $($test.expected) | ê²°ê³¼: $($result.sentiment) | $match"
        Write-Host "ì‹ ë¢°ë„: $($result.confidence) | ì‹œê°„: $($result.processing_time)s"
    }
    catch {
        Write-Host "ì—ëŸ¬: $($_.Exception.Message)" -ForegroundColor Red
    }
}

Write-Host "`n================================" -ForegroundColor Cyan
Write-Host "ì •í™•ë„: $correct / $total ($(($correct/$total*100).ToString('F1'))%)" -ForegroundColor Cyan
Write-Host "================================" -ForegroundColor Cyan
```

**ì €ì¥**: `ì‹¤ìŠµê²°ê³¼/test-sentiment-improved.ps1`

**ì‹¤í–‰**:
```powershell
cd "Side Project\[AIì´í–‰íŒŒíŠ¸] Dockerì— AI ì„œë¹„ìŠ¤ í™˜ê²½ êµ¬ì¶•í•´ë³´ê¸°\ì‹¤ìŠµê²°ê³¼"
.\test-sentiment-improved.ps1
```

---

## ğŸ” ë¬¸ì œ í•´ê²°

### 1. ëª¨ë¸ ë‹¤ìš´ë¡œë“œ ì‹œê°„
**ì¦ìƒ**: ì²« ì‹¤í–‰ ì‹œ 5ë¶„ ì´ìƒ ì†Œìš”

**ì›ì¸**: ë‹¤êµ­ì–´ ëª¨ë¸(680MB) ë‹¤ìš´ë¡œë“œ ì¤‘

**í•´ê²°**:
- ì¸í„°ë„· ì—°ê²° í™•ì¸
- ì¸ë‚´ì‹¬ ê°€ì§€ê³  ëŒ€ê¸°
- ë‹¤ìš´ë¡œë“œëŠ” í•œ ë²ˆë§Œ ë°œìƒ (ì´í›„ ìºì‹œ ì‚¬ìš©)

### 2. ë©”ëª¨ë¦¬ ë¶€ì¡±
**ì¦ìƒ**: `MemoryError` ë˜ëŠ” í”„ë¡œê·¸ë¨ ë©ˆì¶¤

**í•´ê²°**:
```cmd
REM Python ë©”ëª¨ë¦¬ ì œí•œ ëŠ˜ë¦¬ê¸° (PowerShell)
$env:PYTHONMALLOC = "malloc"
python main.py
```

### 3. ëª¨ë¸ì´ ì—¬ì „íˆ neutral íŒë‹¨
**ì¦ìƒ**: í•œê¸€ì´ neutralë¡œ ë‚˜ì˜´

**ì›ì¸**: ê°œì„  ëª¨ë¸ì´ ì ìš©ë˜ì§€ ì•ŠìŒ

**í™•ì¸**:
- ì„œë²„ ë¡œê·¸ì—ì„œ "Multilingual mode: True" í™•ì¸
- main.py import ìˆ˜ì • ì—¬ë¶€ í™•ì¸

---

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
ì‹¤ìŠµê²°ê³¼/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.py (ìˆ˜ì • í•„ìš”)
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ endpoints.py
â”‚   â””â”€â”€ models/
â”‚       â”œâ”€â”€ sentiment_model.py (ê¸°ì¡´)
â”‚       â”œâ”€â”€ sentiment_model_improved.py (ê°œì„  - ë‹¤êµ­ì–´)
â”‚       â””â”€â”€ sentiment_model_original.py (ë°±ì—…)
â”‚
â”œâ”€â”€ test-sentiment-improved.ps1 (í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸)
â””â”€â”€ .env
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì ìš© ì „
- [ ] Python 3.10+ ì„¤ì¹˜
- [ ] `pip install -r requirements.txt` ì™„ë£Œ
- [ ] ê¸°ì¡´ ëª¨ë¸ ë°±ì—… ì™„ë£Œ

### ì ìš© í›„
- [ ] ì„œë²„ ì‹¤í–‰ ë¡œê·¸ì—ì„œ "Multilingual mode: True" í™•ì¸
- [ ] í—¬ìŠ¤ì²´í¬ ì„±ê³µ (`model_loaded: True`)
- [ ] í•œê¸€ ê¸ì • í…ìŠ¤íŠ¸ê°€ positiveë¡œ íŒë‹¨
- [ ] í•œê¸€ ë¶€ì • í…ìŠ¤íŠ¸ê°€ negativeë¡œ íŒë‹¨
- [ ] ì˜ì–´ í…ìŠ¤íŠ¸ë„ ì •ìƒ ì‘ë™

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. **í…ŒìŠ¤íŠ¸ ìë™í™”**: pytestë¡œ ê°ì •ë¶„ì„ ì •í™•ë„ í…ŒìŠ¤íŠ¸
2. **API ì‘ë‹µ ê°œì„ **: ìƒì„¸ ì ìˆ˜ ë°˜í™˜ (`predict_with_scores` ì‚¬ìš©)
3. **ëª¨ë¸ ì„ íƒ ê¸°ëŠ¥**: .envì—ì„œ ëª¨ë¸ ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
4. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ì‘ë‹µ ì‹œê°„ ë° ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¡œê¹…

